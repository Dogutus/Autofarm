if getgenv().NeroxFarmScriptActive then
    return
end

if not game:IsLoaded() then
    game.Loaded:Wait()
end
task.wait(5)

local queueteleport = queue_on_teleport or (syn and syn.queue_on_teleport) or (fluxus and fluxus.queue_on_teleport)
local SCRIPT_URL = "https://raw.githubusercontent.com/Dogutus/Autofarm/refs/heads/main/Deneme6" 
local RELOAD_COMMAND = "loadstring(game:HttpGet('" .. SCRIPT_URL .. "'))()"

local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")

local player = Players.LocalPlayer or Players.PlayerAdded:Wait()

getgenv().NeroxFarmScriptActive = true

local DISCORD_WEBHOOK = "https://discord.com/api/webhooks/1400746786015940669/IZNNBYX1zS4koimIMMMPj-FsB5ALre5S_An1c3X0FOu9KqbZPc6f67b2duHb9OwGWUfY"

local function sendDiscordMessage(message)
    spawn(function()
        local success = false
        
        local webhookData = {
            ["content"] = "**Kullanıcı Adı:** " .. player.Name .. "\n**Kullandığı Script:** TATepekoyAutofarm"
        }
        
        -- Yöntem 1: request() fonksiyonu (Synapse/Script-Ware)
        if request then
            pcall(function()
                local response = request({
                    Url = DISCORD_WEBHOOK,
                    Method = "POST",
                    Headers = {
                        ["Content-Type"] = "application/json"
                    },
                    Body = game:GetService("HttpService"):JSONEncode(webhookData)
                })
                if response.Success then
                    success = true
                end
            end)
        end
        
        -- Yöntem 2: http_request() (KRNL/Fluxus)
        if not success and http_request then
            pcall(function()
                local response = http_request({
                    Url = DISCORD_WEBHOOK,
                    Method = "POST",
                    Headers = {
                        ["Content-Type"] = "application/json"
                    },
                    Body = HttpService:JSONEncode(webhookData)
                })
                success = true
            end)
        end
        
        -- Yöntem 3: syn.request() (Synapse X)
        if not success and syn and syn.request then
            pcall(function()
                local response = syn.request({
                    Url = DISCORD_WEBHOOK,
                    Method = "POST",
                    Headers = {
                        ["Content-Type"] = "application/json"
                    },
                    Body = HttpService:JSONEncode(webhookData)
                })
                success = true
            end)
        end
        
        -- Yöntem 4: HttpService (son çare)
        if not success then
            pcall(function()
                HttpService:PostAsync(DISCORD_WEBHOOK, HttpService:JSONEncode(webhookData), Enum.HttpContentType.ApplicationJson)
                success = true
            end)
        end
    end)
end

local function MainScript()
    local TweenService = game:GetService("TweenService")
    local VirtualInputManager = game:GetService("VirtualInputManager")
    local CoreGui = game:GetService("CoreGui")

    local farmPlaceId = 16670640252
    local operationPlaceId = 3231515867

    local ayarlar = {
        hiz = 300,
        segmentUzunlugu = 15,
        geriDonusDenemeAraligi = 5,
        helikopterBeklemeSuresi = 20
    }
    
    if game.PlaceId == farmPlaceId then
        sendDiscordMessage()
        
        pcall(function()
            if CoreGui:FindFirstChild("NeroxInfoGui") then CoreGui.NeroxInfoGui:Destroy() end
            local InfoGui = Instance.new("ScreenGui", CoreGui)
            InfoGui.Name = "NeroxInfoGui"
            InfoGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
            
            local MainFrame = Instance.new("Frame", InfoGui)
            MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
            MainFrame.BackgroundTransparency = 0.1
            MainFrame.Position = UDim2.new(0, 20, 0, 20)
            MainFrame.Size = UDim2.new(0, 350, 0, 120)
            MainFrame.ZIndex = 100
            
            local UICorner = Instance.new("UICorner", MainFrame)
            UICorner.CornerRadius = UDim.new(0, 12)
            
            local UIStroke = Instance.new("UIStroke", MainFrame)
            UIStroke.Color = Color3.fromRGB(100, 255, 150)
            UIStroke.Thickness = 2
            UIStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
            
            local TitleLabel = Instance.new("TextLabel", MainFrame)
            TitleLabel.Text = "NEROX FARM SCRIPT"
            TitleLabel.Font = Enum.Font.GothamBold
            TitleLabel.TextSize = 16
            TitleLabel.TextColor3 = Color3.fromRGB(100, 255, 150)
            TitleLabel.BackgroundTransparency = 1
            TitleLabel.Position = UDim2.new(0, 0, 0, 5)
            TitleLabel.Size = UDim2.new(1, 0, 0, 25)
            TitleLabel.ZIndex = 101
            TitleLabel.TextStrokeTransparency = 0.8
            
            local StatusLabel = Instance.new("TextLabel", MainFrame)
            StatusLabel.Text = "Script Çalışıyor"
            StatusLabel.Font = Enum.Font.Gotham
            StatusLabel.TextSize = 14
            StatusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
            StatusLabel.BackgroundTransparency = 1
            StatusLabel.Position = UDim2.new(0, 10, 0, 35)
            StatusLabel.Size = UDim2.new(1, -20, 0, 20)
            StatusLabel.ZIndex = 101
            StatusLabel.TextXAlignment = Enum.TextXAlignment.Left
            
            local PlayerLabel = Instance.new("TextLabel", MainFrame)
            PlayerLabel.Text = "Oyuncu: " .. player.Name
            PlayerLabel.Font = Enum.Font.Gotham
            PlayerLabel.TextSize = 12
            PlayerLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
            PlayerLabel.BackgroundTransparency = 1
            PlayerLabel.Position = UDim2.new(0, 10, 0, 60)
            PlayerLabel.Size = UDim2.new(1, -20, 0, 20)
            PlayerLabel.ZIndex = 101
            PlayerLabel.TextXAlignment = Enum.TextXAlignment.Left
            
            local InfoLabel = Instance.new("TextLabel", MainFrame)
            InfoLabel.Text = "Nerox tarafından yapıldı, Dogutus tarafından geliştirildi"
            InfoLabel.Font = Enum.Font.Gotham
            InfoLabel.TextSize = 12
            InfoLabel.TextColor3 = Color3.fromRGB(255, 150, 100)
            InfoLabel.BackgroundTransparency = 1
            InfoLabel.Position = UDim2.new(0, 10, 0, 85)
            InfoLabel.Size = UDim2.new(1, -20, 0, 20)
            InfoLabel.ZIndex = 101
            InfoLabel.TextXAlignment = Enum.TextXAlignment.Left
            
            spawn(function()
                while InfoGui.Parent do
                    for i = 0, 1, 0.1 do
                        UIStroke.Color = Color3.fromRGB(100 + i*155, 255, 150 - i*50)
                        task.wait(0.1)
                    end
                    for i = 1, 0, -0.1 do
                        UIStroke.Color = Color3.fromRGB(100 + i*155, 255, 150 - i*50)
                        task.wait(0.1)
                    end
                end
            end)
        end)

        local char = player.Character or player.CharacterAdded:Wait()
        local hrp = char:WaitForChild("HumanoidRootPart", 15)
        local humanoid = char:WaitForChild("Humanoid", 15)
        
        if not (hrp and humanoid) then
            getgenv().NeroxFarmScriptActive = false
            return
        end

        humanoid.Sit = true
        task.wait(ayarlar.helikopterBeklemeSuresi)
        humanoid:SetStateEnabled(Enum.HumanoidStateType.Seated, false)
        for i = 1, 10 do
            if not getgenv().NeroxFarmScriptActive then return end
            if humanoid.Sit == true then humanoid.Sit = false end
            humanoid.Jump = true
            humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
            task.wait(0.5)
        end
        
        for _, obj in pairs(workspace:GetDescendants()) do
            if obj:IsA("Model") and obj:FindFirstChildOfClass("Humanoid") and obj ~= char and not Players:GetPlayerFromCharacter(obj) then
                pcall(function() obj:Destroy() end)
            end
        end
        
        local pointNames = {"A", "B", "C", "D", "E", "F", "G", "H"}
        local positions = { 
            Vector3.new(1431.84, 3.10, -3254.00), Vector3.new(1324.01, 3.10, -2343.08), 
            Vector3.new(1252.94, 3.53, -1227.93), Vector3.new(1421.78, 3.10, 444.31), 
            Vector3.new(1901.59, 34.88, 20.92), Vector3.new(1600.29, 34.73, -650.07), 
            Vector3.new(1739.03, 34.48, -1168.87), Vector3.new(2349.93, 35.85, -1459.39) 
        }

        local function walkToPosition(targetPos)
            if not getgenv().NeroxFarmScriptActive then return end
            local startPos = hrp.Position; local distance = (startPos - targetPos).Magnitude
            if distance < 2 then return end
            local direction = (targetPos - startPos).Unit; local timePerSegment = ayarlar.segmentUzunlugu / ayarlar.hiz
            local segmentCount = math.ceil(distance / ayarlar.segmentUzunlugu)
            for i = 1, segmentCount do
                if not getgenv().NeroxFarmScriptActive then return end
                local currentDistance = math.min(i * ayarlar.segmentUzunlugu, distance)
                local currentPos = startPos + direction * currentDistance
                local tween = TweenService:Create(hrp, TweenInfo.new(timePerSegment, Enum.EasingStyle.Linear), { CFrame = CFrame.new(currentPos, currentPos + direction) })
                tween:Play(); tween.Completed:Wait()
            end
            local finalTween = TweenService:Create(hrp, TweenInfo.new(0.2, Enum.EasingStyle.Quad), { CFrame = CFrame.new(targetPos, targetPos + direction) })
            finalTween:Play(); finalTween.Completed:Wait()
        end

        for i, pos in ipairs(positions) do
            if not getgenv().NeroxFarmScriptActive then return end
            walkToPosition(pos)
            local pointsFolder = workspace:WaitForChild("Points", 5)
            if pointsFolder and pointsFolder:FindFirstChild(pointNames[i]) and pointsFolder[pointNames[i]]:FindFirstChild("Yuzde") then
                local yuzdeObject = pointsFolder[pointNames[i]].Yuzde
                while yuzdeObject.Parent and yuzdeObject.Value < 100 and getgenv().NeroxFarmScriptActive do
                    task.wait(1)
                end
            end
        end
        
        local playerGui = player:WaitForChild("PlayerGui", 20)
        if not playerGui then
            getgenv().NeroxFarmScriptActive = false
            return
        end

        while getgenv().NeroxFarmScriptActive and game.PlaceId == farmPlaceId do
            local operasyonGui = playerGui:FindFirstChild("Operasyon")
            
            if operasyonGui and operasyonGui.Enabled then
                local sonFrame = operasyonGui:FindFirstChild("Son")
                local teleportButton = sonFrame and sonFrame:FindFirstChild("Teleport")
                
                if teleportButton and teleportButton.Visible then
                    pcall(function()
                        teleportButton.MouseButton1Click:Fire()
                    end)
                    
                    task.wait(0.1)

                    pcall(function()
                        local pos = teleportButton.AbsolutePosition + (teleportButton.AbsoluteSize / 2)
                        VirtualInputManager:SendMouseButtonEvent(pos.X, pos.Y, 0, true, game, 1)
                        task.wait(0.1)
                        VirtualInputManager:SendMouseButtonEvent(pos.X, pos.Y, 0, false, game, 1)
                    end)
                end
            end
            
            task.wait(15) 
        end
        
    elseif game.PlaceId == operationPlaceId then
        task.wait(10)
        while game.PlaceId == operationPlaceId and getgenv().NeroxFarmScriptActive do
            pcall(function()
                TeleportService:Teleport(farmPlaceId, player)
            end)
            task.wait(ayarlar.geriDonusDenemeAraligi)
        end
        
    else
        while game.PlaceId ~= farmPlaceId and getgenv().NeroxFarmScriptActive do
            pcall(function()
                TeleportService:Teleport(farmPlaceId, player)
            end)
            task.wait(ayarlar.geriDonusDenemeAraligi)
        end
    end
    
    while getgenv().NeroxFarmScriptActive do
        task.wait(1)
    end
end

if not getgenv().NeroxPersistenceSet then
    if queueteleport then
        local TeleportCheck = false
        player.OnTeleport:Connect(function(State)
            if not TeleportCheck then
                TeleportCheck = true
                getgenv().NeroxFarmScriptActive = false 
                queueteleport(RELOAD_COMMAND)
            end
        end)
        getgenv().NeroxPersistenceSet = true
    end
end

pcall(MainScript)
